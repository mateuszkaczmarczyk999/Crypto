@model Array
@{
    ViewBag.Title = "Curency Market";
}
<body>
    <h2>Curency Market</h2>

    <div class="container">
        <table class="table table-bordered">
            <tbody>
                @for (int i = 0; i < Model.Length; i++)
                {
                    <tr>
                        <th>@Model.GetValue(i).ToString().ToUpper()</th>

                        @for (int j = 0; j < Model.Length; j++)
                        {
                            if (i != j)
                            {
                                <td id=@i@j>_ @Model.GetValue(j).ToString().ToUpper()</td>
                            }
                        }
                    </tr>
                }

            </tbody>
        </table>
    </div>
@section scripts {
    <!--Script references. -->
    <!--The jQuery library is required and is referenced by default in _Layout.cshtml. -->
    <!--Reference the SignalR library. -->
    <script src="~/Scripts/jquery.signalR-2.2.2.min.js"></script>
    <!--Reference the autogenerated SignalR hub script. -->
    <script src="~/signalr/hubs"></script>
    <!--SignalR script to update the chat page and send messages.-->
    <script>
        
        $(function() {
            
            var market = $.connection.marketHub;

            market.client.updateRates = function (currencyRateArg) {
                var first_arrow;
                var second_arrow;
                var action = currencyRateArg.PriceAction;
                if (action == 1) {
                    first_arrow = '▲';
                    second_arrow = '▼';
                }
                else if (action == 2) {
                    first_arrow = '▼';
                    second_arrow = '▲';
                } else {
                    first_arrow = ' ';
                    second_arrow = ' ';
                }
                var first_value = currencyRateArg.Value;
                var first_id = currencyRateArg.ChangeFrom.toString() + currencyRateArg.ChangeTo.toString();
                var second_value = 1/currencyRateArg.Value;
                var second_id = currencyRateArg.ChangeTo.toString() + currencyRateArg.ChangeFrom.toString();

                console.log(first_id + '-' + first_value);
                console.log(second_id + '-' + second_value);
                var first_text = $('#' + first_id).text();
                var second_text = $('#' + second_id).text();
                $('#' + first_id).text(first_text.replace('_', first_value + ' ' + first_arrow));
                $('#' + second_id).text(second_text.replace('_', second_value + ' ' + second_arrow));
            }

            
            console.log(market);
            $.connection.hub.start().done(function () {
                //alert("Test");
                //market.server.testMethod();
            });
        });
    </script>
}
            




